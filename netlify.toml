# Remove this line after restart
 
<IfModule mod_headers.c>
    Header unset Server
    Header set Server "Healthbridge"
</IfModule>
 
<IfModule mod_rewrite.c>
  # Redirect all HTTP traffic to HTTPS
  RewriteEngine On
  RewriteCond %{HTTPS} !=on
  RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301,NE]
 
  # Hide all PHP extensions
  RewriteCond %{REQUEST_FILENAME} !-d
  RewriteCond %{REQUEST_FILENAME}\.php -f
  RewriteRule ^(.*)$ $1.php [NC,L]
</IfModule>
 
 
<IfModule mod_headers.c>
  # Remove headers that expose sensitive information
  Header unset X-Powered-By
  Header unset Server
 
  # Apply security headers
  Header always set Content-Security-Policy "default-src 'self'; script-src 'self' 'unsafe-inline'; object-src 'none'; upgrade-insecure-requests;"
  Header always set Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"
  Header always set X-Frame-Options SAMEORIGIN
  Header always set X-XSS-Protection "1; mode=block"
  Header always set X-Content-Type-Options nosniff
  Header always set Referrer-Policy "no-referrer"
  Header always set Cross-Origin-Embedder-Policy "require-corp"
  Header always set Cross-Origin-Opener-Policy "same-origin"
  Header always set Cross-Origin-Resource-Policy "same-origin"
  Header always set Permissions-Policy "geolocation=(), midi=(), notifications=()"
 
  # Ensure cookies have proper attributes
  Header always edit Set-Cookie ^(.*)$ $1;HttpOnly;Secure;SameSite=Lax
</IfModule>
 
# Force HTTPS for well-known paths
RewriteEngine On
RewriteCond %{HTTPS} !=on
RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301,NE]
 
# Add a Content Security Policy to resolve mixed-content warnings
Header always set Content-Security-Policy "upgrade-insecure-requests;"
 
# Custom 404 error page
ErrorDocument 404 /404_error_page.php
 
# Set timezone if necessary (optional)
# php_value date.timezone 'Europe/London'
 
 
# SSL certificate validation path
RewriteRule ^.well-known/(.*)$ - [L]